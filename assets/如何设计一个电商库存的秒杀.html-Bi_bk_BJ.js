import{_ as t}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as l,d as i,o}from"./app-mbwvGqXF.js";const r={};function a(n,e){return o(),l("div",null,e[0]||(e[0]=[i('<h2 id="秒杀应该考虑哪些问题" tabindex="-1"><a class="header-anchor" href="#秒杀应该考虑哪些问题"><span>秒杀应该考虑哪些问题</span></a></h2><ol><li><p><strong>超卖问题（首要）</strong></p></li><li><p><strong>高并发</strong></p></li></ol><p>秒杀具有时间短、并发量大的特点，短时间会有大量请求涌向后端</p><p>需要考虑并发过高造成缓存击穿或者失效、击垮数据库</p><ol><li>接口防刷</li><li>秒杀Url</li><li>大量请求问题</li></ol><h2 id="系统设计与方案" tabindex="-1"><a class="header-anchor" href="#系统设计与方案"><span>系统设计与方案</span></a></h2><h3 id="前端" tabindex="-1"><a class="header-anchor" href="#前端"><span>前端</span></a></h3><ol><li><p>秒杀Url的设计</p><p>前端首先访问后端获取具体的秒杀 Url，后台校验之后才可以继续秒杀</p></li><li><p>秒杀页面静态化，扛住流量</p></li><li><p>秒杀按钮截流，禁止重复点击</p></li><li><p>设置概率，直接拒绝一部分的用户请求</p></li></ol><h3 id="后端" tabindex="-1"><a class="header-anchor" href="#后端"><span>后端</span></a></h3><ol><li>使用nginx分发请求到集群中</li><li>部署redis集群，采用哨兵模式</li><li>库存在一开始就在Redis中设值，库存的增删都在Redis中操作</li><li>接口限流（网关、令牌桶、Redis setNx判断是否重复下单）</li><li>异步下单</li></ol><p>使用队列（本地队列、消息队列）削峰，在请求经过限流、库存等的校验之后，就可以认为是一个有效请求，就可以发送到队列进行下单操作，最终入库</p><h3 id="bilibili评论区" tabindex="-1"><a class="header-anchor" href="#bilibili评论区"><span><strong>Bilibili评论区</strong></span></a></h3><p>CDN边缘计算扛前端静态页面流量，设定概率，一部分用户请求直接被前端js脚本拒绝，不发请求直接显示秒杀结束。</p><p>lvs keepalive nginx集群负载均衡流量到网关集群，网关鉴权，令牌桶限流，流量一致性哈希进入redis多副本分片集群，库存拆分给redis各个节点去抢，decr命令或lua脚本原子性扣减库存，抢了之后发送消息到RocketMQ集群，返回提示订单创建中，消费者集群异步写入订单到PolarDB集群，消费成功后告知用户成功</p><h3 id="参考资料" tabindex="-1"><a class="header-anchor" href="#参考资料"><span>参考资料</span></a></h3><p><a href="https://mp.weixin.qq.com/s/aMr5CrR-_57SN1M6UNVBUQ" target="_blank" rel="noopener noreferrer">面试官：如何设计出骚气的秒杀系统？</a></p>',16)]))}const s=t(r,[["render",a],["__file","如何设计一个电商库存的秒杀.html.vue"]]),d=JSON.parse(`{"path":"/resource/code/%E5%9C%BA%E6%99%AF%E9%A2%98/01_%E7%94%B5%E5%95%86/%E5%A6%82%E4%BD%95%E8%AE%BE%E8%AE%A1%E4%B8%80%E4%B8%AA%E7%94%B5%E5%95%86%E5%BA%93%E5%AD%98%E7%9A%84%E7%A7%92%E6%9D%80.html","title":"如何设计一个电商库存的秒杀","lang":"zh-CN","frontmatter":{"title":"如何设计一个电商库存的秒杀","tag":["电商","秒杀"],"description":"秒杀应该考虑哪些问题 超卖问题（首要） 高并发 秒杀具有时间短、并发量大的特点，短时间会有大量请求涌向后端 需要考虑并发过高造成缓存击穿或者失效、击垮数据库 接口防刷 秒杀Url 大量请求问题 系统设计与方案 前端 秒杀Url的设计 前端首先访问后端获取具体的秒杀 Url，后台校验之后才可以继续秒杀 秒杀页面静态化，扛住流量 秒杀按钮截流，禁止重复点击...","head":[["meta",{"property":"og:url","content":"https://logycoconut.github.io/resource/code/%E5%9C%BA%E6%99%AF%E9%A2%98/01_%E7%94%B5%E5%95%86/%E5%A6%82%E4%BD%95%E8%AE%BE%E8%AE%A1%E4%B8%80%E4%B8%AA%E7%94%B5%E5%95%86%E5%BA%93%E5%AD%98%E7%9A%84%E7%A7%92%E6%9D%80.html"}],["meta",{"property":"og:site_name","content":"logycoconut's k-lab"}],["meta",{"property":"og:title","content":"如何设计一个电商库存的秒杀"}],["meta",{"property":"og:description","content":"秒杀应该考虑哪些问题 超卖问题（首要） 高并发 秒杀具有时间短、并发量大的特点，短时间会有大量请求涌向后端 需要考虑并发过高造成缓存击穿或者失效、击垮数据库 接口防刷 秒杀Url 大量请求问题 系统设计与方案 前端 秒杀Url的设计 前端首先访问后端获取具体的秒杀 Url，后台校验之后才可以继续秒杀 秒杀页面静态化，扛住流量 秒杀按钮截流，禁止重复点击..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2025-02-11T14:19:39.000Z"}],["meta",{"property":"article:tag","content":"电商"}],["meta",{"property":"article:tag","content":"秒杀"}],["meta",{"property":"article:modified_time","content":"2025-02-11T14:19:39.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"如何设计一个电商库存的秒杀\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2025-02-11T14:19:39.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"logycoconut\\",\\"url\\":\\"https://logycoconut.github.io/\\"}]}"]]},"headers":[{"level":2,"title":"秒杀应该考虑哪些问题","slug":"秒杀应该考虑哪些问题","link":"#秒杀应该考虑哪些问题","children":[]},{"level":2,"title":"系统设计与方案","slug":"系统设计与方案","link":"#系统设计与方案","children":[{"level":3,"title":"前端","slug":"前端","link":"#前端","children":[]},{"level":3,"title":"后端","slug":"后端","link":"#后端","children":[]},{"level":3,"title":"Bilibili评论区","slug":"bilibili评论区","link":"#bilibili评论区","children":[]},{"level":3,"title":"参考资料","slug":"参考资料","link":"#参考资料","children":[]}]}],"git":{"createdTime":1676991217000,"updatedTime":1739283579000,"contributors":[{"name":"logycoconut","username":"logycoconut","email":"logycoconut@foxmail.com","commits":8,"url":"https://github.com/logycoconut"}]},"readingTime":{"minutes":1.72,"words":515},"filePathRelative":"resource/code/场景题/01_电商/如何设计一个电商库存的秒杀.md","localizedDate":"2023年2月21日","autoDesc":true}`);export{s as comp,d as data};
